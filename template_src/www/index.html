<!DOCTYPE html>

<html>

<head>

    <meta name="format-detection" content="telephone=no">
    <meta name="msapplication-tap-highlight" content="no">
    <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">

    <link rel="stylesheet" type="text/css" href="css/index.css">


    <link rel="stylesheet" href="./lib/onsenui/css/onsenui.css">
    <link rel="stylesheet" href="./lib/onsenui/css/onsen-css-components.min.css">
    <script src="./lib/onsenui/js/onsenui.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>COVID-19 Tracker</title>
</head>

<body>
    <ons-navigator swipeable id="myNavigator" page="home.html"></ons-navigator>
    <ons-page id="main-page">
        <ons-toolbar>
            <div class="center">COVID-19 Tracker</div>
            <div class="right">
                <!-- <ons-toolbar-button id="home-button">
                    <ons-icon icon="md-home"></ons-icon>
                </ons-toolbar-button> -->
            </div>
        </ons-toolbar>

        <ons-tabbar swipeable position="bottom">
            <ons-tab page="first-template" label="Home" icon="md-home" active>
            </ons-tab>
            <ons-tab page="prevention-template" label="Prevention" icon="md-face">
            </ons-tab>
            <ons-tab page="list-template" label="List" icon="md-book">
            </ons-tab>
            <ons-tab page="pref-template" label="Preferences" icon="md-settings">
            </ons-tab>
        </ons-tabbar>
    </ons-page>
    <template id="first-template">
        <ons-page id="first-page">
                <div class="content content-container">
                 

                    <div class="btn-space">
                        <ons-button class="btn-link" onclick="checkPref()">CHECK PREF</ons-button>
                    </div>
                    <div span id="msgSpace"></div>
                </div>
        </ons-page>
    </template>

<!--  PREVENTION TEMPLATE  -->
     <template id="prevention-template">
        <ons-page id="first-page">
                <div class="content content-container">
                        <h1> COVID-19 Prevention </h1>
                        <div class="prevention-card"> 
                            <table>
                                <tr class="prevention-row">
                                <td> <h2>Wear a mask </h2><span class="prevention-text">Wear a cloth face mask in public to protect others and yourself.</span></td>
                                <td> <img class="covid-svg" src="img/mask-girl.svg"></td>
                            </tr>
                                 <tr>
                                <td> <img class="covid-svg" src="img/wash.svg"></td>
                                <td> <h2>Wash your hands</h2><span class="prevention-text">Wash your hands often or use hand sanitizer.</span></td>
                            </tr>
                             <tr>
                                <td> <h2>Distance yourself</h2><span class="prevention-text"> Keep 2m distance from others when in public.</span></td>
                                <td> <img class="covid-svg" src="img/distance.svg"></td>
                            </tr>
                             <tr>
                                <td> <img class="covid-svg" src="img/keep-track.svg"></td>
                                <td> <h2>Keep track</h2><span class="prevention-text">Make a list of the people you contact and notify them if you contract COVID-19.</span></td>
                            </tr>
                            <tr>
                                <td> <h2>Stay home</h2><span class="prevention-text"> Avoid leaving the house when you can, and stay home if you feel sick. </span></td>
                                <td> <img class="covid-svg" src="img/home.svg"></td>
                            </tr>
                             <tr>
                                <td> <img class="covid-svg" src="img/doctor.svg"></td>
                                <td> <h2>Get tested</h2><span class="prevention-text">Contact a medical professional for a COVID-19 test if experiencing symptoms.</span></td>
                            </tr>
                            </table>
                        </div>
                </div>
        </ons-page>
    </template>


    <template id="pref-template">
        <ons-page id="pref-page">
            
            <div class="content content-container">
                <h1>Preferences</h1>

                <div class="form-group">
                    <label for="country">Type A Country</label>
                    <div><ons-input input-id="country" class="form-field-full" modifier="underbar"></ons-input></div>
                </div>

                

                <div class="btn-space">
                    <ons-button class="btn-link" onclick="savePref()">UPDATE</ons-button>
                    <ons-button class="btn-link" onclick="clearPref()">CLEAR</ons-button>
                </div>
            </div>

            
        </ons-page>
    </template>
    <template id="list-template">

        <ons-page id="list">
            

            <div style="margin-top: 5px; width: 100%; display: flex; justify-content: center;" class="center">

            </div>
            </ons-toolbar>
            <ons-list id="web-list-node">
            </ons-list>


        </ons-page>
    </template>

    <template id="Detail.html">
        <ons-page id="Detail">
            <ons-toolbar>
                <div class="left">
                    <ons-back-button id="reset">home</ons-back-button>
                </div>
                <div class="center"></div>
            </ons-toolbar>

            <div style=" display:flex; justify-content: center; width: 100%; background-color: transparent;"><img
                    style="width: 80%;" id="SingleImg"></div>
            <div class="text-center">
                <h1 id="SingleTitle"></h1>
            </div>
            <div style="text-align: center;">
                <h4 id="SingleContent"></h4>
            </div>
            <div class="center desc-card" style="padding-left: 10%;">
                <table>
                <tr> 
                     <td class="table-hd">Total Confirmed: </td>
                     <td>
                    <p class="content" id="totalConfirmed"></p>
                    </td>
                </tr>
                <tr>
                     <td class="table-hd">Total Deaths: </td>
                     <td>
                    <p class="content" id="totalDeaths"></p>
                    </td>
                    </tr>
                <tr>
                     <td class="table-hd">Total Recovered: </td>
                     <td>
                    <p class="content" id="totalRecovered"></p>
                    </td>
                    </tr>
                <tr>
                     <td class="table-hd">New Confirmed: </td>
                     <td>
                    <p class="content" id="newConfirmed"></p>
                    </td>
                    </tr>
               <tr>
                 <td class="table-hd">New Deaths: </td>
                 <td>
                <p class="content" id="newDeaths"></p>
                </td>
                </tr>
               <tr>
                 <td class="table-hd">New Recovered: </td>
                 <td>
                <p class="content" id="newRecovered"></p>
                </td>
                </tr>
                <tr>
                     <td>
                    <p class="content" style="position:absolute; bottom: 20px;" id="date"></p>
                    </td>
                </tr>
                </table>
            </div>


        </ons-page>
    </template>

    <ons-modal id="spinner-modal">
        <div style="margin: auto;">
            <ons-icon icon="md-spinner" size="100px" spin></ons-icon>
        </div>
    </ons-modal>

    <script type="text/javascript" src="js/covid-id.js"></script>
    <script type="text/javascript" src="js/userPref.js"></script>
    <script type="text/javascript" src="js/covid.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="cordova.js"></script>

    <script>
        // since we are using tabs we can just set the home button universally
        document.querySelector('#home-button').onclick = function() {
            window.location = './index.html';
        };

        document.addEventListener('init', function(event) {
            // get a reference to the element (page that fired the init event)
            var page = event.target;

            if (page.id === 'pref-page') {
                setPrefFields();
            }

        });

        function checkPref() {

            var firstPage = document.getElementById('first-page');
            var currPref = window.localStorage.getItem('userPref');
            
           
            var selectCountry = JSON.parse(currPref).country;
            
            

            if (currPref !== null) {
                firstPage.querySelector('#msgSpace').innerHTML = selectCountry;
                getpref(selectCountry);
            } else {
                firstPage.querySelector('#msgSpace').innerHTML = "No preferences in LocalStorage";
            }
        }

        function savePref() {
            var prefPage = document.getElementById('pref-page');

            var currPref = {
                country: prefPage.querySelector('#country').value
            };

            // iterate over interests
            var interestSwitches = prefPage.querySelectorAll('.int-switch');
            for (let i = 0; i < interestSwitches.length; i++) {

                currPref.interests.push({
                    fieldId: interestSwitches[i].getAttribute('input-id'),
                    fieldVal: interestSwitches[i].checked
                });
            }

            window.localStorage.setItem('userPref', JSON.stringify(currPref));
        }

        function clearPref() {
            window.localStorage.removeItem('userPref');
        }

        function setPrefFields() {
            // get the stored values if they exist                
            var currPrefObj = window.localStorage.getItem('userPref');

            if (currPrefObj !== null) {
                // since we want them as an object we will parse
                currPrefObj = JSON.parse(currPrefObj);

                var prefPage = document.getElementById('pref-page');

                // normally we'd set defaults for null values here but we'll keep it simple
                prefPage.querySelector('#country').value = currPrefObj.country;


                for (let i = 0; i < currPrefObj.interests.length; i++) {
                    prefPage.querySelector('#' + currPrefObj.interests[i].fieldId).checked =
                        currPrefObj.interests[i].fieldVal;
                }

            }
        }
    </script>
</body>

</html>